<div *ngIf="battling" class="container">
  <div class="d-flex justify-content-center">

    <div [@flyInFromSide]="'in'" class="p-5">
      <div class="card">
        <div class="card-block">
          <h3 class="card-title">{{battlingPokemon?.name}}</h3>
          <img class="card-img-top" src="{{battlingPokemon?.sprites[1]}}" alt="Card image cap">
          <!-- <div class="health">{{battlingPokemon?.currentHP}}/{{battlingPokemon?.maxHP}}</div> -->

          <div class="myProgress">
            <div id="myBar" [style.width.%]="(battlingPokemon?.currentHP/battlingPokemon?.maxHP)*100">
              {{battlingPokemon?.currentHP}}/{{battlingPokemon?.maxHP}}
            </div>
          </div>

          <div class="d-flex justify-content-around stats">
            <div class="p-1">Speed</div>
            <div class="p-1">Attack</div>
            <div class="p-1">Defense</div>
          </div>
          <div class="d-flex justify-content-around stats">
            <div class="p-1">{{battlingPokemon?.speed}}</div>
            <div class="p-1">{{battlingPokemon?.attack}}</div>
            <div class="p-1">{{battlingPokemon?.defense}}</div>
          </div>
          <div class="d-flex justify-content-between level-type">
            <div class="p-1">Lvl. {{battlingPokemon?.level}}</div>
            <div class="p-1"><span *ngFor="let type of battlingPokemon?.types" class="pokemon-type">{{type.type.name}} </span></div>
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="p-2"><button (click)="battle(0)">{{battlingPokemon.activeMoves[0].name}}</button></div>
          <div *ngIf="battlingPokemon.activeMoves.length > 1" class="p-2"><button (click)="battle(1)">{{battlingPokemon.activeMoves[1].name}}</button></div>
        </div>
        <div class="d-flex justify-content-center">
          <div *ngIf="battlingPokemon.activeMoves.length > 2" class="p-2"><button (click)="battle(2)">{{battlingPokemon.activeMoves[2].name}}</button></div>
          <div *ngIf="battlingPokemon.activeMoves.length > 3" class="p-2"><button (click)="battle(3)">{{battlingPokemon.activeMoves[3].name}}</button></div>
        </div>
        <div class="d flex-box justify-content-center center-log">
          <div class="card">
            <div class="card-block">
              <div></div>
              <div class="player-log">{{playerLog}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

  <div [@flyInFromRightSide]="'in'" class="p-5">
    <div class="card">
      <div class="card-block">
        <h3 class="card-title">{{opponent?.name}}</h3>
        <img class="card-img-top" src="{{opponent.sprites[0]}}" alt="Card image cap">
        <!-- <div class="health">{{opponent?.currentHP}}/{{opponent?.maxHP}}</div> -->

        <div class="enemyProgress">
          <div id="enemyProgressBar" [style.width.%]="(opponent?.currentHP/opponent?.maxHP)*100">
            {{opponent?.currentHP}}/{{opponent?.maxHP}}
          </div>
        </div>


        <div class="d-flex justify-content-around stats">
          <div class="p-1">Speed</div>
          <div class="p-1">Attack</div>
          <div class="p-1">Defense</div>
        </div>
        <div class="d-flex justify-content-around stats">
          <div class="p-1">{{opponent?.speed}}</div>
          <div class="p-1">{{opponent?.attack}}</div>
          <div class="p-1">{{opponent?.defense}}</div>
        </div>
        <div class="d-flex justify-content-between level-type">
          <div class="p-1">Lvl. {{opponent?.level}}</div>
          <div class="p-1"><span *ngFor="let type of opponent?.types" class="pokemon-type">{{type.type.name}} </span></div>
        </div>
      </div>
      <div class="d-flex justify-content-center">
        <div class="p-2"><button (click)="catchPokemon()">Catch</button></div>
        <div class="p-2"><a routerLink="/map"><button>Flee</button></a></div>
      </div>
      <div class="d flex-box justify-content-center center-log">
        <div class="card">
          <div class="card-block">
            <div></div>
            <div class="opponent-log">{{opponentLog}}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>


<div *ngIf="(battleWon || !battleWon) && !battling">
  <h1 id="end-battle">The Battle Is Over!</h1>

  <div class="d-flex justify-content-center">

    <div class="p-5">
      <div class="card">
        <div class="card-block" *ngIf="battleWon">
          <h3 class="card-title">{{battlingPokemon?.name}} won!</h3>
          <img class="card-img-top" src="{{battlingPokemon?.sprites[0]}}" alt="Card image cap">

          <div class="xp-gained">
            {{this.battlingPokemon.name}} gained {{opponent?.level * 5}} xp!
          </div>


          <div class="health">{{battlingPokemon?.currentHP}}/{{battlingPokemon?.maxHP}}</div>

          <!-- <div class="health">{{battlingPokemon?.currentHP}}/{{battlingPokemon?.maxHP}}</div> -->
          <div class="d-flex justify-content-between level-type">
            <div class="p-1">Lvl. {{battlingPokemon?.level}}</div>
            <div class="p-1"><span *ngFor="let type of battlingPokemon?.types" class="pokemon-type">{{type.type.name}} </span></div>
          </div>
        </div>
        <div class="card-block" *ngIf="!battleWon">
          <h3 class="card-title">{{battlingPokemon?.name}} lost!</h3>
          <img class="card-img-top" src="{{battlingPokemon?.sprites[0]}}" alt="Card image cap">

          <div class="d-flex justify-content-between level-type">
            <div class="p-1">Lvl. {{battlingPokemon?.level}}</div>
            <div class="p-1"><span *ngFor="let type of battlingPokemon?.types" class="pokemon-type">{{type.type.name}} </span></div>
          </div>

        </div>

      </div>
      <div class="btn-center">
          <button type="button" name="button" class="btn btn-warning " (click)="backToMap()">Back to Map</button>
      </div>

    </div>
  </div>

</div>
<div *ngIf="(battling)">
  <app-my-pokemon [battling]="battling" (switchPokemonSender)="switchPokemon($event)"></app-my-pokemon>
</div>
